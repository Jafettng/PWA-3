<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="LK Studio | Belleza que Empodera: Especialista en uñas, maquillaje y colorimetría en Tulcingo de Valle, Puebla.">
        <meta property="og:title" content="LK Studio | Belleza que Empodera">
        <meta property="og:description" content="Especialista en uñas, maquillaje y colorimetría con 7 años de experiencia">
        <meta property="og:image" content="img/oro_preview.png">
        <meta property="og:url" content="">
        <meta property="og:type" content="website">
        <meta name="theme-color" content="#ffb6c1" />
        <meta http-equiv="X-UA-Compatible" content="IE-edge">

        <!-- Titulo -->
        <title>Santa Cruz Guerrero</title>

        <!-- Ícono -->
        <link rel="icon" href="img/6d7b7208-4bdb-442c-ae2c-19e84ed5a4f7.png" type="image/x-icon">

        <!--Fuentes-->
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Shantell+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

        <!----- Configuracion de Meta etiquetas para que funcione nuestra PWA ----->

        <!-- Manifest PWA -->
        <link rel="manifest" href="manifest.json">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

        <!-- Estilos base -->
        <link rel="stylesheet" href="css/style.css" type="text/css">
        
    </head>

    <body>
        <!-- Architecture App Shell -->
        <div id="app-shell">
            <!-- Menú de navegación -->
            <nav id="nav" class="navbar navbar-expand-lg navbar-dark fixed-top bg-black shadow-lg border-bottom border-warning"></nav>

            <!-- Contenido dinámico -->
            <main id="content">
                <div class="loading">Cargando...</div>
            </main>

            <!-- Pie de página -->
            <footer id="footer"></footer>

            <!-- Modal Login -->
            <div class="modal fade" id="modalLogin" tabindex="-1">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content bg-dark text-light border-success">
                        <!--Modal-Encabezado-->
                        <div class="modal-header border-success">
                            <h1 class="modal-title text-success">Iniciar sesión</h1>
                            <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>

                        <!--Modal Cuerpo-->
                        <div class="modal-body">

                        <div id="msgLogin"></div>
                            <form  id="loginForm">
                                <input type="hidden" name="action" value="Login">
                                <div class="mb-3">
                                    <label for="usuario_email" class="col-form-label">Correo:</label>
                                    <input type="text" class="form-control" id="login_correo" maxlength="50" required>
                                </div>
                                <div class="mb-3">
                                    <label for="usuario_nombre" class="col-form-label">Nombre:</label>
                                    <input type="text" class="form-control" id="login_nombre" maxlength="15" required>
                                </div>
                                <div class="mb-3">
                                    <button type="submit" class="btn btn-success w-100 hover-glow">Aceptar</button>
                                </div>
                            </form>
                        </div>

                        <!--Modal Pie-->
                        <div class="modal-footer">                            
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--LightBox-->
        <div id="lightbox" class="lightbox">
            <span class="lightbox-close">&times;</span>
            <img class="lightbox-img" src="" alt="">
        </div>

        <!-- Scripts  -->
         <script>

            // ---- Local Store ----//
            document.addEventListener("submit",(e) => {

                if(!e.target.matches("#loginForm")) return;

                e.preventDefault();

                const nombreInput = e.target.querySelector("#login_nombre");
                const correoInput = e.target.querySelector("#login_correo");

                if (!nombreInput || !correoInput){
                    console.error("Input no encontrado");
                    return;
                } 
                
                console.log(nombreInput, correoInput);

                const nombre = nombreInput.value.trim();
                const correo = correoInput.value.trim();

                if (!nombre || !correo) {
                    alert("Completa todos los campos");
                    return;
                }

                localStorage.setItem("usuario_nombre", nombre);
                localStorage.setItem("usuario_correo", correo); 

            console.log("Datos guardados en Local Storage");
            
            // Cerrar modal
            const modalElement = document.getElementById('modalLogin');
            const modalInstance = bootstrap.Modal.getInstance(modalElement);
    
            if(modalInstance) {
                modalInstance.hide();
            } else {
                // Si no existe instancia, crearla y luego cerrar
                const newModalInstance = new bootstrap.Modal(modalElement);
                newModalInstance.hide();
            }
            }); 

            // Borrar datos
            document.addEventListener("click", (e) => {
                 if (e.target && e.target.id === "btnLogout") {
                    localStorage.removeItem("usuario_nombre");
                    localStorage.removeItem("usuario_correo");
                    location.reload();
                    console.log("Sesión cerrada. Local Storage limpio.");
                }
            });

            //---- LightBox ----//
            document.addEventListener("DOMContentLoaded", () => {
                const lightbox = document.getElementById("lightbox");
                const lightboxImg = document.querySelector(".lightbox-img");
                const closeBtn = document.querySelector(".lightbox-close");

                document.querySelectorAll(".lightbox-trigger").forEach(img => {
                    img.addEventListener("click", () => {
                        lightboxImg.src = img.src;
                        lightbox.classList.add("active");
                    });
                });
                closeBtn.addEventListener("click", () => {
                    lightbox.classList.remove("active");
                });

                lightbox.addEventListener("click", e => {
                    if (e.target === lightbox) {
                        lightbox.classList.remove("active");
                    }
                });
            });

            // ---- Notificacion y Formulario Whatsapp ----//

            document.addEventListener("submit", async function(e) {

                if(!e.target.matches("#whatsappForm")) return;

                e.preventDefault();

                const nombreEl = e.target.querySelector("#nombrewapps");
                const correoEl = e.target.querySelector("#correo");
                const telefonoEl = e.target.querySelector("#telefono");
                const mensajeEl = e.target.querySelector("#mensaje");

                if(!nombreEl  || !correoEl || !telefonoEl || !mensajeEl) return;

                    const nombre = nombreEl.value.trim();
                    const correo = correoEl.value.trim();
                    const telefono = telefonoEl.value.trim();
                    const mensaje = mensajeEl.value.trim();

                    const texto =
                        `Nombre: ${nombre}%0A` +
                        `Correo: ${correo}%0A` +
                        `Teléfono: ${telefono}%0A` +
                        `Mensaje: ${mensaje}`;

                    try {
                        if ('Notification' in window && 'serviceWorker' in navigator) {

                        if (Notification.permission === 'default') {
                            await Notification.requestPermission();
                        }

                        if (Notification.permission === 'granted') {
                            const reg = await navigator.serviceWorker.ready;
                            reg.showNotification('WhatsApp', {
                            body: 'Mensaje enviado correctamente',
                            icon: '/img/icon-192.png',
                            vibrate: [200, 100, 200],
                            tag: 'whatsapp-submit',
                            renotify: true
                            });
                        }
                        }
                    } catch (err) {
                        console.warn('Notificación omitida');
                    }

                    const numeroWhatsapp = "7571511481"; 
                    const url = `https://wa.me/${numeroWhatsapp}?text=${encodeURIComponent(texto)}`;
                    window.open(url, '_blank');
            });
         </script>

        <!-- Documentos Java Scripts -->
        <script src="js/router.js"></script>
        <script src="js/app.js"></script>
        <script src="js/sw_register.js"></script>
        <script src="sw.js"></script>
        

        <!-- Bootstrap JS (bundle incluye Popper) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
            
    </body>

</html>